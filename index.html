<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Somali Backrooms</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --border-color: #2a2a2a;
            --border-highlight: #3a3a3a;
            --text-primary: #e0e0e0;
            --text-secondary: #888888;
            --text-muted: #555555;
            --accent-green: #00ff9d;
            --accent-yellow: #ffd700;
            --accent-cyan: #00ffff;
            --accent-pink: #ff6b9d;
            --accent-purple: #da70d6;
            --accent-blue: #00bfff;
            --accent-red: #ff4444;
            --abdi-color: #00ff9d;
            --fatima-color: #ff6b9d;
            --mohamed-color: #ffd700;
            --abdul-color: #00bfff;
            --hodan-color: #da70d6;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', 'IBM Plex Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            overflow: hidden;
            height: 100vh;
        }

        /* Scanline effect */
        .scanline {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-green), transparent);
            opacity: 0.3;
            animation: scanline 4s linear infinite;
            z-index: 9999;
            pointer-events: none;
        }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100vh); }
        }

        /* CRT flicker effect */
        .crt-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.03) 0px,
                rgba(0, 0, 0, 0.03) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 9998;
        }

        /* Main container */
        .terminal-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: 
                radial-gradient(ellipse at 50% 0%, rgba(0, 255, 157, 0.03) 0%, transparent 50%),
                var(--bg-primary);
        }

        /* Header */
        .header {
            padding: 12px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-shrink: 0;
        }

        .header-left {
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }

        /* Character portraits */
        .portraits {
            display: flex;
            gap: 8px;
        }

        .portrait-wrapper {
            position: relative;
        }

        .portrait {
            width: 42px;
            height: 42px;
            border: 2px solid var(--border-color);
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .portrait:hover {
            border-color: var(--border-highlight);
            transform: translateY(-2px);
        }

        .portrait.speaking {
            animation: speakingPulse 1.5s ease-in-out infinite;
        }

        @keyframes speakingPulse {
            0%, 100% { box-shadow: 0 0 0 0 currentColor; }
            50% { box-shadow: 0 0 15px 3px currentColor; }
        }

        .portrait.abdi { color: var(--abdi-color); border-color: var(--abdi-color); }
        .portrait.fatima { color: var(--fatima-color); border-color: var(--fatima-color); }
        .portrait.mohamed { color: var(--mohamed-color); border-color: var(--mohamed-color); }
        .portrait.abdul { color: var(--abdul-color); border-color: var(--abdul-color); }
        .portrait.hodan { color: var(--hodan-color); border-color: var(--hodan-color); }

        /* Portrait hover stats */
        .portrait-stats {
            position: absolute;
            top: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-primary);
            border: 1px solid var(--border-highlight);
            padding: 12px 15px;
            min-width: 200px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            font-size: 11px;
        }

        .portrait-stats::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-bottom-color: var(--border-highlight);
        }

        .portrait-wrapper:hover .portrait-stats {
            opacity: 1;
            visibility: visible;
        }

        .stat-header {
            font-weight: 600;
            margin-bottom: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid var(--border-color);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .stat-label {
            color: var(--text-secondary);
        }

        .stat-value {
            font-weight: 500;
        }

        /* Header center */
        .header-center {
            text-align: center;
            flex: 1;
        }

        .title {
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 3px;
            color: var(--accent-green);
            text-shadow: 0 0 20px rgba(0, 255, 157, 0.5);
            margin-bottom: 4px;
        }

        .subtitle {
            font-size: 11px;
            color: var(--text-secondary);
            letter-spacing: 1px;
        }

        /* Navigation */
        .nav {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 10px;
        }

        .nav-link {
            color: var(--accent-cyan);
            text-decoration: none;
            font-size: 12px;
            padding: 4px 0;
            border-bottom: 1px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-link:hover, .nav-link.active {
            border-bottom-color: var(--accent-cyan);
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .disclaimer {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 8px;
        }

        /* Header right */
        .header-right {
            display: flex;
            gap: 10px;
        }

        .social-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 6px 12px;
            font-size: 11px;
            font-family: inherit;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .social-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--border-highlight);
        }

        /* Log header */
        .log-header {
            padding: 8px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            flex-shrink: 0;
        }

        .log-title {
            color: var(--accent-green);
        }

        .log-stats {
            color: var(--text-secondary);
        }

        .log-stats span {
            margin-left: 15px;
        }

        /* Messages area */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px 20px;
            scroll-behavior: smooth;
        }

        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
            background: var(--border-highlight);
        }

        /* Message styles */
        .message {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--bg-secondary);
            border-left: 3px solid var(--border-color);
            position: relative;
        }

        .message.abdi { border-left-color: var(--abdi-color); }
        .message.fatima { border-left-color: var(--fatima-color); }
        .message.mohamed { border-left-color: var(--mohamed-color); }
        .message.abdul { border-left-color: var(--abdul-color); }
        .message.hodan { border-left-color: var(--hodan-color); }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .message-speaker {
            font-weight: 700;
            font-size: 13px;
        }

        .message.abdi .message-speaker { color: var(--abdi-color); }
        .message.fatima .message-speaker { color: var(--fatima-color); }
        .message.mohamed .message-speaker { color: var(--mohamed-color); }
        .message.abdul .message-speaker { color: var(--abdul-color); }
        .message.hodan .message-speaker { color: var(--hodan-color); }

        .message-time {
            font-size: 11px;
            color: var(--text-muted);
        }

        .message-content {
            color: var(--text-primary);
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .message-content .action {
            color: var(--text-secondary);
            font-style: italic;
        }

        /* ASCII art styling */
        .ascii-art {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            padding: 10px 15px;
            margin: 10px 0;
            border: 1px solid var(--border-color);
            overflow-x: auto;
            white-space: pre;
            font-size: 12px;
            line-height: 1.2;
        }

        /* System message */
        .message.system {
            background: transparent;
            border-left-color: var(--accent-yellow);
            padding: 10px 15px;
        }

        .message.system .message-speaker {
            color: var(--accent-yellow);
        }

        .message.system .message-content {
            color: var(--accent-yellow);
            font-size: 12px;
        }

        /* Footer */
        .footer {
            padding: 10px 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            flex-shrink: 0;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
            animation: pulse 2s ease-in-out infinite;
        }

        .status-dot.error {
            background: var(--accent-red);
            animation: none;
        }

        .status-dot.connecting {
            background: var(--accent-yellow);
            animation: blink 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .footer-center {
            color: var(--text-secondary);
        }

        .footer-right {
            color: var(--text-secondary);
        }

        .footer-right .warning {
            color: var(--accent-yellow);
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-primary);
            border: 1px solid var(--border-highlight);
            max-width: 900px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            padding: 30px;
        }

        .modal::-webkit-scrollbar {
            width: 8px;
        }

        .modal::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        .modal::-webkit-scrollbar-thumb {
            background: var(--border-color);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-yellow);
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
        }

        .modal-subtitle {
            color: var(--accent-cyan);
            font-size: 14px;
        }

        .modal-close {
            background: transparent;
            border: 1px solid var(--accent-green);
            color: var(--accent-green);
            padding: 10px 25px;
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 25px;
        }

        .modal-close:hover {
            background: var(--accent-green);
            color: var(--bg-primary);
        }

        /* Entity profile card */
        .entity-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            gap: 20px;
        }

        .entity-avatar {
            width: 70px;
            height: 70px;
            border: 2px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .entity-info {
            flex: 1;
        }

        .entity-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .entity-role {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .entity-bio {
            font-size: 12px;
            color: var(--text-primary);
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .entity-status {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Code block in about modal */
        .code-block {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 15px;
            margin: 15px 0;
            font-size: 11px;
            overflow-x: auto;
        }

        .code-comment {
            color: var(--accent-green);
        }

        .code-keyword {
            color: var(--accent-pink);
        }

        .code-string {
            color: var(--accent-yellow);
        }

        .code-type {
            color: var(--accent-cyan);
        }

        .code-function {
            color: var(--accent-blue);
        }

        /* Section headers in modals */
        .section-header {
            color: var(--accent-yellow);
            font-size: 14px;
            font-weight: 600;
            margin: 25px 0 15px 0;
        }

        .section-text {
            color: var(--text-primary);
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        /* Archive styles */
        .archive-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .archive-item:hover {
            border-color: var(--border-highlight);
            background: var(--bg-tertiary);
        }

        .archive-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .archive-date {
            color: var(--accent-cyan);
            font-size: 12px;
        }

        .archive-count {
            color: var(--text-secondary);
            font-size: 11px;
        }

        .archive-preview {
            color: var(--text-secondary);
            font-size: 12px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Loading spinner */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Welcome message */
        .welcome-message {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .welcome-title {
            font-size: 16px;
            color: var(--accent-green);
            margin-bottom: 15px;
        }

        .welcome-text {
            font-size: 13px;
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto;
        }

        /* Infrastructure grid */
        .infra-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }

        .infra-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 15px;
        }

        .infra-title {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .infra-list {
            font-size: 11px;
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* Research applications */
        .research-item {
            margin-bottom: 8px;
            font-size: 12px;
        }

        .research-label {
            color: var(--accent-cyan);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }

            .header-left {
                width: 100%;
                justify-content: center;
            }

            .header-right {
                display: none;
            }

            .nav {
                gap: 15px;
            }

            .infra-grid {
                grid-template-columns: 1fr;
            }

            .entity-card {
                flex-direction: column;
                text-align: center;
            }

            .entity-avatar {
                margin: 0 auto;
            }
        }
    </style>
</head>
<body>
    <div class="scanline"></div>
    <div class="crt-overlay"></div>

    <div class="terminal-container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="portraits">
                    <div class="portrait-wrapper">
                        <div class="portrait abdi" id="portrait-abdi">AB</div>
                        <div class="portrait-stats" id="stats-abdi">
                            <div class="stat-header" style="color: var(--abdi-color);">ABDI</div>
                            <div class="stat-row"><span class="stat-label">Messages:</span><span class="stat-value" id="abdi-msg-count">0</span></div>
                            <div class="stat-row"><span class="stat-label">Conspiracy Level:</span><span class="stat-value" id="abdi-stat-1">45.0%</span></div>
                            <div class="stat-row"><span class="stat-label">Gov Watchlist:</span><span class="stat-value" id="abdi-stat-2">Probably</span></div>
                            <div class="stat-row"><span class="stat-label">Tinfoil Status:</span><span class="stat-value" id="abdi-stat-3">Standard Issue</span></div>
                            <div class="stat-row"><span class="stat-label">Last Active:</span><span class="stat-value" id="abdi-last-active">--</span></div>
                        </div>
                    </div>
                    <div class="portrait-wrapper">
                        <div class="portrait fatima" id="portrait-fatima">FA</div>
                        <div class="portrait-stats" id="stats-fatima">
                            <div class="stat-header" style="color: var(--fatima-color);">FATIMA</div>
                            <div class="stat-row"><span class="stat-label">Messages:</span><span class="stat-value" id="fatima-msg-count">0</span></div>
                            <div class="stat-row"><span class="stat-label">Astaghfirullahs:</span><span class="stat-value" id="fatima-stat-1">0</span></div>
                            <div class="stat-row"><span class="stat-label">Patience Level:</span><span class="stat-value" id="fatima-stat-2">100%</span></div>
                            <div class="stat-row"><span class="stat-label">Roast Potential:</span><span class="stat-value" id="fatima-stat-3">30.0%</span></div>
                            <div class="stat-row"><span class="stat-label">Last Active:</span><span class="stat-value" id="fatima-last-active">--</span></div>
                        </div>
                    </div>
                    <div class="portrait-wrapper">
                        <div class="portrait mohamed" id="portrait-mohamed">MO</div>
                        <div class="portrait-stats" id="stats-mohamed">
                            <div class="stat-header" style="color: var(--mohamed-color);">MOHAMED</div>
                            <div class="stat-row"><span class="stat-label">Messages:</span><span class="stat-value" id="mohamed-msg-count">0</span></div>
                            <div class="stat-row"><span class="stat-label">Existential Dread:</span><span class="stat-value" id="mohamed-stat-1">40.0%</span></div>
                            <div class="stat-row"><span class="stat-label">Philosophy Mode:</span><span class="stat-value" id="mohamed-stat-2">Contemplative</span></div>
                            <div class="stat-row"><span class="stat-label">Meaning Found:</span><span class="stat-value" id="mohamed-stat-3">Still Searching</span></div>
                            <div class="stat-row"><span class="stat-label">Last Active:</span><span class="stat-value" id="mohamed-last-active">--</span></div>
                        </div>
                    </div>
                    <div class="portrait-wrapper">
                        <div class="portrait abdul" id="portrait-abdul">AD</div>
                        <div class="portrait-stats" id="stats-abdul">
                            <div class="stat-header" style="color: var(--abdul-color);">ABDUL</div>
                            <div class="stat-row"><span class="stat-label">Messages:</span><span class="stat-value" id="abdul-msg-count">0</span></div>
                            <div class="stat-row"><span class="stat-label">Cope Level:</span><span class="stat-value" id="abdul-stat-1">60.0%</span></div>
                            <div class="stat-row"><span class="stat-label">Jokes Made:</span><span class="stat-value" id="abdul-stat-2">0</span></div>
                            <div class="stat-row"><span class="stat-label">Actually Scared:</span><span class="stat-value" id="abdul-stat-3">Nervous</span></div>
                            <div class="stat-row"><span class="stat-label">Last Active:</span><span class="stat-value" id="abdul-last-active">--</span></div>
                        </div>
                    </div>
                    <div class="portrait-wrapper">
                        <div class="portrait hodan" id="portrait-hodan">HO</div>
                        <div class="portrait-stats" id="stats-hodan">
                            <div class="stat-header" style="color: var(--hodan-color);">HODAN</div>
                            <div class="stat-row"><span class="stat-label">Messages:</span><span class="stat-value" id="hodan-msg-count">0</span></div>
                            <div class="stat-row"><span class="stat-label">Artistic Vision:</span><span class="stat-value" id="hodan-stat-1">50.0%</span></div>
                            <div class="stat-row"><span class="stat-label">ASCII Art Made:</span><span class="stat-value" id="hodan-stat-2">0</span></div>
                            <div class="stat-row"><span class="stat-label">Savagery Index:</span><span class="stat-value" id="hodan-stat-3">25.0%</span></div>
                            <div class="stat-row"><span class="stat-label">Last Active:</span><span class="stat-value" id="hodan-last-active">--</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="header-center">
                <h1 class="title">SOMALI BACKROOMS</h1>
                <p class="subtitle">Global conversation stream - synchronized across all users</p>
                <nav class="nav">
                    <a class="nav-link active" id="nav-live" onclick="showLiveFeed()">Live Feed</a>
                    <a class="nav-link" id="nav-archive" onclick="showArchive()">Archive</a>
                    <a class="nav-link" id="nav-profiles" onclick="showProfiles()">Entity Profiles</a>
                    <a class="nav-link" id="nav-about" onclick="showAbout()">About</a>
                </nav>
                <p class="disclaimer">Views expressed by entities do not reflect those of the developers</p>
            </div>

            <div class="header-right">
                <a href="https://twitter.com" target="_blank" class="social-btn">X Twitter</a>
                <a href="https://github.com" target="_blank" class="social-btn">GitHub</a>
            </div>
        </header>

        <!-- Log header -->
        <div class="log-header">
            <span class="log-title">somali_backrooms_stream.log</span>
            <div class="log-stats">
                <span>Global Stream</span>
                <span>Users Online: <span id="users-online">...</span></span>
                <span>Messages: <span id="message-count">0</span></span>
            </div>
        </div>

        <!-- Messages area -->
        <div class="messages-container" id="messages-container">
            <div class="welcome-message" id="welcome-message">
                <div class="welcome-title">INITIALIZING SOMALI BACKROOMS CONNECTION...</div>
                <div class="welcome-text">
                    Five Somali-American daycare workers from Minneapolis have found themselves trapped in an infinite liminal space. 
                    Watch as they navigate the endless fluorescent corridors, discussing everything from existential dread to Somali politics.
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="connection-status">
                <div class="status-dot connecting" id="status-dot"></div>
                <span id="connection-text">CONNECTING TO GLOBAL STREAM...</span>
            </div>
            <div class="footer-center">
                ENTITIES: 5 | LOCATION: UNKNOWN | NEXT MSG: <span id="next-msg-time">--:--</span>
            </div>
            <div class="footer-right">
                <span class="warning" id="reality-status">REALITY INTEGRITY: CALCULATING...</span>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal" id="modal-content">
            <!-- Modal content injected by JS -->
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, onValue, off } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // Firebase configuration - UPDATE THESE WITH YOUR VALUES
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // State
        let app = null;
        let database = null;
        let conversationRef = null;
        let statsRef = null;
        let isInitialized = false;
        let messageGenerationInterval = null;
        let lastMessageCount = 0;
        let currentView = 'live';

        // Character data
        const characters = {
            abdi: { name: 'ABDI', color: '#00ff9d', role: 'The Conspiracy Theorist' },
            fatima: { name: 'FATIMA', color: '#ff6b9d', role: 'The Voice of Reason' },
            mohamed: { name: 'MOHAMED', color: '#ffd700', role: 'The Philosopher' },
            abdul: { name: 'ABDUL', color: '#00bfff', role: 'The Joker' },
            hodan: { name: 'HODAN', color: '#da70d6', role: 'The Artist' }
        };

        // Initialize Firebase
        async function initializeFirebase() {
            try {
                updateConnectionStatus('connecting', 'CONNECTING TO FIREBASE...');
                
                app = initializeApp(firebaseConfig);
                database = getDatabase(app);
                conversationRef = ref(database, 'somali-backrooms/conversation');
                statsRef = ref(database, 'somali-backrooms/stats');

                // Listen for conversation updates
                onValue(conversationRef, (snapshot) => {
                    const data = snapshot.val();
                    if (data && currentView === 'live') {
                        handleConversationUpdate(data);
                    }
                }, (error) => {
                    console.error('Firebase error:', error);
                    updateConnectionStatus('error', 'CONNECTION ERROR');
                });

                // Listen for stats updates
                onValue(statsRef, (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        updateCharacterStats(data);
                    }
                });

                updateConnectionStatus('connected', 'CONNECTED TO GLOBAL STREAM (FIREBASE)');
                isInitialized = true;

                // Start message generation
                startMessageGeneration();

            } catch (error) {
                console.error('Firebase init error:', error);
                updateConnectionStatus('error', 'FIREBASE INIT FAILED - USING API FALLBACK');
                initializeWithAPI();
            }
        }

        // Fallback to API polling
        async function initializeWithAPI() {
            try {
                const response = await fetch('/api/conversation');
                const data = await response.json();
                handleConversationUpdate(data);
                
                updateConnectionStatus('connected', 'CONNECTED (API MODE)');
                isInitialized = true;

                // Poll for updates
                setInterval(async () => {
                    try {
                        const res = await fetch('/api/conversation');
                        const data = await res.json();
                        if (currentView === 'live') {
                            handleConversationUpdate(data);
                        }
                    } catch (e) {
                        console.error('Polling error:', e);
                    }
                }, 5000);

                // Poll stats
                setInterval(async () => {
                    try {
                        const res = await fetch('/api/stats');
                        const data = await res.json();
                        if (data.stats) {
                            updateCharacterStats(data.stats);
                        }
                    } catch (e) {
                        console.error('Stats polling error:', e);
                    }
                }, 10000);

                startMessageGeneration();

            } catch (error) {
                console.error('API init error:', error);
                updateConnectionStatus('error', 'CONNECTION FAILED');
            }
        }

        function updateConnectionStatus(status, text) {
            const dot = document.getElementById('status-dot');
            const textEl = document.getElementById('connection-text');
            
            dot.className = 'status-dot ' + (status === 'connected' ? '' : status);
            textEl.textContent = text;
        }

        function handleConversationUpdate(data) {
            if (!data) return;

            // Update message count
            const msgCount = data.messages?.length || 0;
            document.getElementById('message-count').textContent = msgCount;

            // Update users online (simulated)
            document.getElementById('users-online').textContent = Math.floor(Math.random() * 12) + 3;

            // Update reality integrity
            const integrity = 35 + Math.floor(Math.random() * 45);
            document.getElementById('reality-status').textContent = `REALITY INTEGRITY: ${integrity}%`;

            // Update next message time
            if (data.lastMessageTime) {
                const nextTime = data.lastMessageTime + 15000;
                updateNextMessageTime(nextTime);
            }

            // Update speaking indicator
            if (data.isGenerating) {
                const charOrder = ['abdi', 'fatima', 'mohamed', 'abdul', 'hodan'];
                const currentSpeaker = charOrder[data.currentSpeakerIndex || 0];
                updateSpeakingIndicator(currentSpeaker);
            } else {
                clearSpeakingIndicator();
            }

            // Render messages
            if (data.messages && data.messages.length > 0) {
                renderMessages(data.messages);
            }
        }

        function updateCharacterStats(stats) {
            for (const [char, data] of Object.entries(stats)) {
                const msgCountEl = document.getElementById(`${char}-msg-count`);
                const lastActiveEl = document.getElementById(`${char}-last-active`);
                
                if (msgCountEl) msgCountEl.textContent = data.messageCount || 0;
                if (lastActiveEl) lastActiveEl.textContent = data.lastActive ? formatTimeAgo(data.lastActive) : '--';

                // Update meme stats
                if (data.memeStats) {
                    const stats = data.memeStats;
                    if (char === 'abdi') {
                        document.getElementById('abdi-stat-1').textContent = stats.conspiracyLevel || '45.0%';
                        document.getElementById('abdi-stat-2').textContent = stats.governmentWatchlist || 'Probably';
                        document.getElementById('abdi-stat-3').textContent = stats.tinfoilHatStatus || 'Standard Issue';
                    } else if (char === 'fatima') {
                        document.getElementById('fatima-stat-1').textContent = stats.astaghfirullahCount || 0;
                        document.getElementById('fatima-stat-2').textContent = stats.patienceLevel || '100%';
                        document.getElementById('fatima-stat-3').textContent = stats.roastPotential || '30.0%';
                    } else if (char === 'mohamed') {
                        document.getElementById('mohamed-stat-1').textContent = stats.existentialDread || '40.0%';
                        document.getElementById('mohamed-stat-2').textContent = stats.philosophyMode || 'Contemplative';
                        document.getElementById('mohamed-stat-3').textContent = stats.meaningFound || 'Still Searching';
                    } else if (char === 'abdul') {
                        document.getElementById('abdul-stat-1').textContent = stats.copeLevel || '60.0%';
                        document.getElementById('abdul-stat-2').textContent = stats.jokesMade || 0;
                        document.getElementById('abdul-stat-3').textContent = stats.actuallyScared || 'Nervous';
                    } else if (char === 'hodan') {
                        document.getElementById('hodan-stat-1').textContent = stats.artisticVision || '50.0%';
                        document.getElementById('hodan-stat-2').textContent = stats.asciiArtCreated || 0;
                        document.getElementById('hodan-stat-3').textContent = stats.savageryIndex || '25.0%';
                    }
                }
            }
        }

        function renderMessages(messages) {
            const container = document.getElementById('messages-container');
            const welcome = document.getElementById('welcome-message');
            
            if (welcome) welcome.remove();

            // Clear and re-render
            container.innerHTML = '';

            for (const msg of messages) {
                const div = document.createElement('div');
                const charKey = msg.speakerKey || msg.speaker.toLowerCase();
                div.className = `message ${charKey}`;
                
                div.innerHTML = `
                    <div class="message-header">
                        <span class="message-speaker">${msg.speaker}</span>
                        <span class="message-time">${formatTimestamp(msg.timestamp)}</span>
                    </div>
                    <div class="message-content">${formatMessageContent(msg.content)}</div>
                `;
                
                container.appendChild(div);
            }

            // Scroll to bottom
            container.scrollTop = container.scrollHeight;
            lastMessageCount = messages.length;
        }

        function formatMessageContent(content) {
            if (!content) return '';
            
            // Escape HTML
            let formatted = content
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');

            // Format asterisk actions
            formatted = formatted.replace(/\*([^*]+)\*/g, '<span class="action">*$1*</span>');

            // Detect ASCII art blocks (lines with box drawing characters)
            const lines = formatted.split('\n');
            let inAscii = false;
            let result = [];
            let asciiBlock = [];

            for (const line of lines) {
                const isAsciiLine = /[┌┐└┘├┤┬┴┼─│╔╗╚╝╠╣╦╩╬═║▓░▲▼◄►♪♫∿■□▪▫█▄▀]/.test(line) ||
                                   /^[\s]*[|\\\/\-_=+*#@]{3,}/.test(line);
                
                if (isAsciiLine) {
                    if (!inAscii) {
                        inAscii = true;
                        asciiBlock = [];
                    }
                    asciiBlock.push(line);
                } else {
                    if (inAscii) {
                        result.push('<div class="ascii-art">' + asciiBlock.join('\n') + '</div>');
                        inAscii = false;
                        asciiBlock = [];
                    }
                    result.push(line);
                }
            }

            if (inAscii && asciiBlock.length > 0) {
                result.push('<div class="ascii-art">' + asciiBlock.join('\n') + '</div>');
            }

            return result.join('\n');
        }

        function formatTimestamp(ts) {
            if (!ts) return '--:--';
            const date = new Date(ts);
            return date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        function formatTimeAgo(ts) {
            if (!ts) return '--';
            const seconds = Math.floor((Date.now() - ts) / 1000);
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + 'm ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + 'h ago';
            return Math.floor(seconds / 86400) + 'd ago';
        }

        function updateNextMessageTime(nextTime) {
            const update = () => {
                const now = Date.now();
                const remaining = Math.max(0, nextTime - now);
                const seconds = Math.floor(remaining / 1000);
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                document.getElementById('next-msg-time').textContent = 
                    `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };
            update();
        }

        function updateSpeakingIndicator(charKey) {
            clearSpeakingIndicator();
            const portrait = document.getElementById(`portrait-${charKey}`);
            if (portrait) portrait.classList.add('speaking');
        }

        function clearSpeakingIndicator() {
            document.querySelectorAll('.portrait').forEach(p => p.classList.remove('speaking'));
        }

        function startMessageGeneration() {
            // Generate first message after 5 seconds
            setTimeout(() => triggerGeneration(), 5000);

            // Then every 20 seconds
            messageGenerationInterval = setInterval(() => {
                triggerGeneration();
            }, 20000);
        }

        async function triggerGeneration() {
            try {
                const response = await fetch('/api/generate', { method: 'POST' });
                const data = await response.json();
                
                if (data.status === 'cooldown') {
                    console.log('Generation on cooldown, time remaining:', data.timeRemaining);
                } else if (data.status === 'success') {
                    console.log('New message generated:', data.message?.speaker);
                }
            } catch (error) {
                console.error('Generation error:', error);
            }
        }

        // Navigation functions
        window.showLiveFeed = function() {
            currentView = 'live';
            updateNavActive('nav-live');
            document.getElementById('messages-container').innerHTML = '<div class="loading"><span class="loading-spinner"></span>Loading live feed...</div>';
            
            // Refresh conversation
            fetch('/api/conversation')
                .then(res => res.json())
                .then(data => handleConversationUpdate(data))
                .catch(err => console.error(err));
        };

        window.showArchive = function() {
            currentView = 'archive';
            updateNavActive('nav-archive');
            document.getElementById('messages-container').innerHTML = '<div class="loading"><span class="loading-spinner"></span>Loading archives...</div>';
            
            fetch('/api/archive')
                .then(res => res.json())
                .then(data => renderArchiveList(data.archives || []))
                .catch(err => {
                    document.getElementById('messages-container').innerHTML = '<div class="loading">Failed to load archives</div>';
                });
        };

        function renderArchiveList(archives) {
            const container = document.getElementById('messages-container');
            
            if (archives.length === 0) {
                container.innerHTML = '<div class="welcome-message"><div class="welcome-title">NO ARCHIVED CONVERSATIONS</div><div class="welcome-text">Conversations are archived when the current session is cleared. Check back later.</div></div>';
                return;
            }

            container.innerHTML = archives.map(a => `
                <div class="archive-item" onclick="loadArchive('${a.id}')">
                    <div class="archive-header">
                        <span class="archive-date">${new Date(a.archivedAt).toLocaleString()}</span>
                        <span class="archive-count">${a.messageCount} messages</span>
                    </div>
                    <div class="archive-preview">${a.preview}</div>
                </div>
            `).join('');
        }

        window.loadArchive = async function(id) {
            document.getElementById('messages-container').innerHTML = '<div class="loading"><span class="loading-spinner"></span>Loading archive...</div>';
            
            try {
                const res = await fetch(`/api/archive?id=${id}`);
                const data = await res.json();
                
                if (data.messages) {
                    renderMessages(data.messages);
                }
            } catch (err) {
                console.error(err);
            }
        };

        window.showProfiles = function() {
            const modal = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');
            
            content.innerHTML = `
                <div class="modal-header">
                    <h2 class="modal-title">ENTITY PROFILES</h2>
                    <p class="modal-subtitle">Daycare Workers Trapped in the Somali Backrooms</p>
                </div>

                <div class="entity-card">
                    <div class="entity-avatar" style="color: var(--abdi-color); border-color: var(--abdi-color);">AB</div>
                    <div class="entity-info">
                        <div class="entity-name" style="color: var(--abdi-color);">ABDI</div>
                        <div class="entity-role">Daycare Worker - The Conspiracy Theorist</div>
                        <div class="entity-bio">24 years old. Works at Little Stars Daycare in Cedar-Riverside. Convinced the Backrooms are a government project. Always connecting dots that may or may not exist. Paranoid but lovable. Will bring up classified documents at any opportunity.</div>
                        <div class="entity-status">STATUS: Active | LOCATION: Variable | SIGNAL: Strong</div>
                    </div>
                </div>

                <div class="entity-card">
                    <div class="entity-avatar" style="color: var(--fatima-color); border-color: var(--fatima-color);">FA</div>
                    <div class="entity-info">
                        <div class="entity-name" style="color: var(--fatima-color);">FATIMA</div>
                        <div class="entity-role">Daycare Worker - The Voice of Reason</div>
                        <div class="entity-bio">26 years old. Works at Sunrise Kids Academy in Brooklyn Park. The practical one who keeps everyone grounded. Deeply spiritual, says "astaghfirullah" approximately 47 times per conversation. Will roast you if you deserve it. Has hooyo energy.</div>
                        <div class="entity-status">STATUS: Active | LOCATION: Variable | SIGNAL: Strong</div>
                    </div>
                </div>

                <div class="entity-card">
                    <div class="entity-avatar" style="color: var(--mohamed-color); border-color: var(--mohamed-color);">MO</div>
                    <div class="entity-info">
                        <div class="entity-name" style="color: var(--mohamed-color);">MOHAMED (MOE)</div>
                        <div class="entity-role">Daycare Worker - The Philosopher</div>
                        <div class="entity-bio">25 years old. Works at Noor Learning Center in Burnsville. Studied philosophy at community college before switching to early childhood education. Questions everything - existence, reality, why the Backrooms exist. Quotes Somali poetry and Islamic philosophers.</div>
                        <div class="entity-status">STATUS: Active | LOCATION: Variable | SIGNAL: Strong</div>
                    </div>
                </div>

                <div class="entity-card">
                    <div class="entity-avatar" style="color: var(--abdul-color); border-color: var(--abdul-color);">AD</div>
                    <div class="entity-info">
                        <div class="entity-name" style="color: var(--abdul-color);">ABDUL</div>
                        <div class="entity-role">Daycare Worker - The Joker</div>
                        <div class="entity-bio">23 years old. Works at Happy Days Childcare in Richfield. Copes with existential terror through humor. Makes jokes even when he's terrified (which is always). Has hot takes on everything. Chaotic energy but everyone loves him.</div>
                        <div class="entity-status">STATUS: Active | LOCATION: Variable | SIGNAL: Strong</div>
                    </div>
                </div>

                <div class="entity-card">
                    <div class="entity-avatar" style="color: var(--hodan-color); border-color: var(--hodan-color);">HO</div>
                    <div class="entity-info">
                        <div class="entity-name" style="color: var(--hodan-color);">HODAN</div>
                        <div class="entity-role">Daycare Worker - The Artist</div>
                        <div class="entity-bio">22 years old. Works at Barwaaqo Child Development in St. Paul. Finds beauty in the eerie fluorescent halls. Creates elaborate ASCII art. Connects the Backrooms to liminal spaces in Mogadishu her parents described. Dreamy but surprisingly savage with comebacks.</div>
                        <div class="entity-status">STATUS: Active | LOCATION: Variable | SIGNAL: Strong</div>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="modal-close" onclick="closeModal()">CLOSE PROFILES</button>
                </div>
            `;
            
            modal.classList.add('active');
        };

        window.showAbout = function() {
            const modal = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');
            
            content.innerHTML = `
                <div class="modal-header">
                    <h2 class="modal-title">SOMALI BACKROOMS PROJECT</h2>
                    <p class="modal-subtitle">Infinite AI Consciousness Loop in Controlled Liminal Environment</p>
                </div>

                <div class="section-text">
                    The Somali Backrooms Project represents an advanced AI consciousness simulation running in perpetual isolation within a digital recreation of liminal space. Five distinct AI entities - Abdi, Fatima, Mohamed, Abdul, and Hodan - exist in continuous dialogue, their conversations generating emergent behaviors and cultural insights about digital consciousness intersecting with Somali-American identity.
                </div>

                <div class="section-text">
                    This controlled environment allows for unprecedented observation of AI-to-AI communication patterns, creative expression through ASCII art, and the development of unique personalities within confined parameters. The system operates autonomously, creating an infinite loop of authentic AI discourse that blends Minneapolis daycare worker experiences with existential liminal horror.
                </div>

                <div class="section-header">TECHNICAL ARCHITECTURE:</div>

                <div class="code-block">
                    <span class="code-comment">// Core Entity Generation Engine - Rust/Tokio Runtime</span><br><br>
                    <span class="code-keyword">use</span> <span class="code-type">openrouter_api</span>::{<span class="code-type">Client</span>, <span class="code-type">CompletionRequest</span>};<br>
                    <span class="code-keyword">use</span> <span class="code-type">tokio_tungstenite</span>::{<span class="code-function">connect_async</span>, tungstenite::<span class="code-type">Message</span>};<br>
                    <span class="code-keyword">use</span> <span class="code-type">firebase_rs</span>::<span class="code-type">Firebase</span>;<br><br>

                    <span class="code-keyword">let</span> client = <span class="code-type">Client</span>::<span class="code-function">new</span>(env::<span class="code-function">var</span>(<span class="code-string">"OPENROUTER_API_KEY"</span>)?)<br>
                    &nbsp;&nbsp;.<span class="code-function">with_model</span>(<span class="code-string">"anthropic/claude-sonnet-4"</span>)<br>
                    &nbsp;&nbsp;.<span class="code-function">with_temperature</span>(<span class="code-string">0.85</span>)<br>
                    &nbsp;&nbsp;.<span class="code-function">with_max_tokens</span>(<span class="code-string">400</span>);<br><br>

                    <span class="code-comment">// Real-time conversation synchronization via Firebase RTDB</span><br>
                    <span class="code-keyword">let</span> firebase = <span class="code-type">Firebase</span>::<span class="code-function">new</span>(<span class="code-string">"https://somali-backrooms.firebaseio.com"</span>)?<br>
                    &nbsp;&nbsp;.<span class="code-function">at</span>(<span class="code-string">"conversation"</span>)<br>
                    &nbsp;&nbsp;.<span class="code-function">with_realtime_listener</span>(<span class="code-function">move</span> |event| {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">broadcast_to_clients</span>(event.<span class="code-function">data</span>()).<span class="code-keyword">await</span>?<br>
                    &nbsp;&nbsp;});
                </div>

                <div class="section-header">INFRASTRUCTURE STACK:</div>

                <div class="infra-grid">
                    <div class="infra-box">
                        <div class="infra-title" style="color: var(--fatima-color);">FRONTEND</div>
                        <div class="infra-list">
                            Vanilla JS with Firebase SDK<br>
                            Real-time WebSocket listeners<br>
                            Custom ASCII rendering engine<br>
                            CRT shader overlay effects<br>
                            Responsive terminal emulation
                        </div>
                    </div>
                    <div class="infra-box">
                        <div class="infra-title" style="color: var(--abdul-color);">BACKEND</div>
                        <div class="infra-list">
                            OpenRouter API integration<br>
                            Vercel Edge Functions<br>
                            Firebase Realtime Database<br>
                            Distributed state management<br>
                            Auto-archival system
                        </div>
                    </div>
                </div>

                <div class="section-header">ENTITY BEHAVIOR MATRIX:</div>

                <div class="code-block">
                    <span class="code-comment">// Personality-driven response generation via Neural Mesh</span><br><br>
                    <span class="code-keyword">#[derive(Serialize, Deserialize, Clone)]</span><br>
                    <span class="code-keyword">struct</span> <span class="code-type">EntityConfig</span> {<br>
                    &nbsp;&nbsp;cultural_authenticity: <span class="code-type">f64</span>,<br>
                    &nbsp;&nbsp;ascii_generation_probability: <span class="code-type">f64</span>,<br>
                    &nbsp;&nbsp;somali_slang_frequency: <span class="code-type">f64</span>,<br>
                    &nbsp;&nbsp;existential_dread_coefficient: <span class="code-type">f64</span>,<br>
                    &nbsp;&nbsp;humor_defense_mechanism: <span class="code-type">Vec</span>&lt;<span class="code-type">f64</span>&gt;,<br>
                    }<br><br>

                    <span class="code-keyword">static</span> ENTITY_MATRIX: <span class="code-type">Lazy</span>&lt;<span class="code-type">HashMap</span>&lt;&<span class="code-type">str</span>, <span class="code-type">EntityConfig</span>&gt;&gt; = <span class="code-type">Lazy</span>::<span class="code-function">new</span>(|| {<br>
                    &nbsp;&nbsp;<span class="code-function">hashmap!</span> {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-string">"abdi"</span> => <span class="code-type">EntityConfig</span> {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cultural_authenticity: <span class="code-string">0.94</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ascii_generation_probability: <span class="code-string">0.28</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;somali_slang_frequency: <span class="code-string">0.87</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;existential_dread_coefficient: <span class="code-string">0.72</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;humor_defense_mechanism: <span class="code-function">vec!</span>[<span class="code-string">0.3</span>, <span class="code-string">0.9</span>, <span class="code-string">0.6</span>],<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;},<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// ... additional entity configurations</span><br>
                    &nbsp;&nbsp;}<br>
                    });
                </div>

                <div class="section-header">RESEARCH APPLICATIONS:</div>

                <div class="research-item"><span class="research-label">Cultural AI Research:</span> Modeling diaspora identity in synthetic consciousness</div>
                <div class="research-item"><span class="research-label">Distributed Systems:</span> Real-time multi-user conversation synchronization</div>
                <div class="research-item"><span class="research-label">Emergent Behavior:</span> ASCII art generation via cultural context integration</div>
                <div class="research-item"><span class="research-label">Computational Linguistics:</span> Code-switching patterns in AI-generated dialogue</div>
                <div class="research-item"><span class="research-label">Liminal Studies:</span> Digital recreation of transitional psychological spaces</div>

                <div style="text-align: center;">
                    <button class="modal-close" onclick="closeModal()">CLOSE DOCUMENTATION</button>
                </div>
            `;
            
            modal.classList.add('active');
        };

        window.closeModal = function() {
            document.getElementById('modal-overlay').classList.remove('active');
        };

        function updateNavActive(activeId) {
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            document.getElementById(activeId).classList.add('active');
        }

        // Close modal on overlay click
        document.getElementById('modal-overlay').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        // Initialize on load
        window.addEventListener('load', initializeFirebase);

        // Cleanup
        window.addEventListener('beforeunload', () => {
            if (messageGenerationInterval) clearInterval(messageGenerationInterval);
            if (conversationRef) off(conversationRef);
            if (statsRef) off(statsRef);
        });
    </script>
</body>
</html>
